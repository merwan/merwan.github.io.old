
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Merwan's blog</title>
  <meta name="author" content="Merouane Atig">

  
  <meta name="description" content="Aujourd&#8217;hui, j&#8217;ai voulu intégrer Piwik Web Analytics dans
une application Django sans ajouter de nouvelle dépendance. La solution la plus &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://merwan.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Merwan's blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-48359436-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Merwan's blog</a></h1>
  
    <h2>Rhapsody in code</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:merwan.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/24/deployer-piwik-avec-django/">Déployer Piwik Avec Django</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-24T22:25:39+01:00" pubdate data-updated="true">Feb 24<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Aujourd&#8217;hui, j&#8217;ai voulu intégrer <a href="http://piwik.org/">Piwik Web Analytics</a> dans
une application Django sans ajouter de nouvelle dépendance. La solution la plus
que j&#8217;ai trouvé s&#8217;appuie sur le fichier de settings et la création d&#8217;un
<a href="https://docs.djangoproject.com/en/dev/ref/templates/api/#writing-your-own-context-processors">context processor</a>.</p>

<h2>Définition des variables Piwik dans <code>settings.py</code></h2>

<p>Dans le fichier <code>settings.py</code>, ajouter des variables pour l&#8217;URL de votre instance
Piwik et l&#8217;ID du site.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">PIWIK_IDSITE</span> <span class="o">=</span> <span class="s">&#39;123&#39;</span>
</span><span class='line'><span class="n">PIWIK_URL</span> <span class="o">=</span> <span class="s">&#39;analytics.example.com&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Création du context processor</h2>

<p>Créer un fichier <code>context_processor.py</code> qui lit les variables de Piwik dans le
fichier de settings et les rends accessibles aux templates.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">piwik_analytics</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&#39;PIWIK_URL&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">PIWIK_URL</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;PIWIK_IDSITE&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">PIWIK_IDSITE</span><span class="p">,</span>
</span><span class='line'>    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Ajout du context processor au settings</h2>

<p>Dans le fichier <code>settings.py</code>, ajouter le context processor à <code>TEMPLATE_CONTEXT_PROCESSORS</code>.
Le plus simple pour conserver les context processors par défaut de Django est de les importer
depuis <code>global_settings</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">global_settings</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">TEMPLATE_CONTEXT_PROCESSORS</span> <span class="o">=</span> <span class="n">global_settings</span><span class="o">.</span><span class="n">TEMPLATE_CONTEXT_PROCESSORS</span> <span class="o">+</span> <span class="p">(</span>
</span><span class='line'>    <span class="s">&#39;website.context_processors.piwik_analytics&#39;</span><span class="p">,</span>
</span><span class='line'><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Créer un template pour Piwik</h2>

<p>Je préfère créer un fichier de template spécifique <code>piwik.html</code> qui contient le <a href="http://developer.piwik.org/guides/tracking-javascript-guide">JavaScript
de tracking</a> du site. Ce template
peut référencer les variables <code>PIWIK_URL</code> et <code>PIWIK_IDSITE</code> définies dans le context processor.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">PIWIK_IDSITE</span> <span class="o">%</span><span class="p">}</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">script</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="n">var</span> <span class="n">_paq</span> <span class="o">=</span> <span class="n">_paq</span> <span class="o">||</span> <span class="p">[];</span>
</span><span class='line'>    <span class="p">(</span><span class="n">function</span><span class="p">(){</span> <span class="n">var</span> <span class="n">u</span><span class="o">=</span><span class="p">((</span><span class="s">&quot;https:&quot;</span> <span class="o">==</span> <span class="n">document</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">protocol</span><span class="p">)</span> <span class="err">?</span> <span class="s">&quot;https://{{ PIWIK_URL }}/&quot;</span> <span class="p">:</span> <span class="s">&quot;http://{{ PIWIK_URL }}/&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="n">_paq</span><span class="o">.</span><span class="n">push</span><span class="p">([</span><span class="s">&#39;setSiteId&#39;</span><span class="p">,</span> <span class="p">{{</span> <span class="n">PIWIK_IDSITE</span> <span class="p">}}]);</span>
</span><span class='line'>    <span class="n">_paq</span><span class="o">.</span><span class="n">push</span><span class="p">([</span><span class="s">&#39;setTrackerUrl&#39;</span><span class="p">,</span> <span class="n">u</span><span class="o">+</span><span class="s">&#39;piwik.php&#39;</span><span class="p">]);</span>
</span><span class='line'>    <span class="n">_paq</span><span class="o">.</span><span class="n">push</span><span class="p">([</span><span class="s">&#39;trackPageView&#39;</span><span class="p">]);</span>
</span><span class='line'>    <span class="n">_paq</span><span class="o">.</span><span class="n">push</span><span class="p">([</span><span class="s">&#39;enableLinkTracking&#39;</span><span class="p">]);</span>
</span><span class='line'>    <span class="n">var</span> <span class="n">d</span><span class="o">=</span><span class="n">document</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s">&#39;script&#39;</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s">&#39;script&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">g</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="s">&#39;text/javascript&#39;</span><span class="p">;</span> <span class="n">g</span><span class="o">.</span><span class="n">defer</span><span class="o">=</span><span class="n">true</span><span class="p">;</span> <span class="n">g</span><span class="o">.</span><span class="n">async</span><span class="o">=</span><span class="n">true</span><span class="p">;</span> <span class="n">g</span><span class="o">.</span><span class="n">src</span><span class="o">=</span><span class="n">u</span><span class="o">+</span><span class="s">&#39;piwik.js&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="n">s</span><span class="o">.</span><span class="n">parentNode</span><span class="o">.</span><span class="n">insertBefore</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">s</span><span class="p">);</span> <span class="p">})();</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span><span class='line'><span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ce script est inclus uniquement quand on a renseigné le <code>PIWIK_IDSITE</code>. Ceci permet de choisir de
ne pas envoyer de statistiques lorsqu&#8217;on est en développement par exemple.</p>

<h2>Intégrer le template Piwik dans le site</h2>

<p>La <a href="http://developer.piwik.org/guides/tracking-javascript-guide">documentation de Piwik</a> conseille
d&#8217;ajouter le tracking code juste après le tag <code>&lt;body&gt;</code>. Dans votre fichier <code>base.html</code> ou
équivalent, il faut donc inclure le template piwik que l&#8217;on vient de créer.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span><span class='line'><span class="p">{</span><span class="o">%</span> <span class="n">include</span> <span class="s">&#39;piwik.html&#39;</span> <span class="o">%</span><span class="p">}</span>
</span><span class='line'><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/23/supprimer-toutes-les-tables-avec-django-17/">Supprimer Toutes Les Tables Avec Django 1.7</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-23T17:07:34+01:00" pubdate data-updated="true">Feb 23<span>rd</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Lorsque l&#8217;on veut repartir d&#8217;une base vide avec un projet Django 1.7 qui utilise les
migrations, on peut utiliser la commande:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./manage.py migrate &lt;app&gt; zero
</span><span class='line'># Remplacer &lt;app&gt; par le nom de votre application</span></code></pre></td></tr></table></div></figure>


<p>La migration <code>zero</code> correspond à l&#8217;état juste avant que la première migration ait été
appliquée. Cette commande va ainsi annuler toutes les migrations et supprimer toutes
les tables.</p>

<p>C&#8217;est particulièrement utile lorsque l&#8217;on travaille avec une base PostgreSQL puisque
cela permet d&#8217;éviter de supprimer manuellement la base et de la recréer.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/19/utiliser-XFCE-avec-un-ecran-HiDPI-ou-Retina/">Utiliser XFCE Avec Un écran HiDPI Ou &#8220;Retina&#8221;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-19T09:35:55+02:00" pubdate data-updated="true">Aug 19<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ma nouvelle station de travail est un DELL Precision M4800, modèle équipé d&#8217;un
écran très haute résolution QHD+ 3200x1800 pixels
(<a href="http://en.wikipedia.org/wiki/Retina_Display">aussi appelé HiDPI ou Retina chez Apple</a>).</p>

<p>Malheureusement, ce genre d&#8217;écran n&#8217;est pas encore très bien supporté sous Linux. Pour
avoir une résolution d&#8217;écran acceptable sur une Ubuntu avec XFCE, j&#8217;ai donc suivi les
<a href="https://wiki.archlinux.org/index.php/HiDPI">instructions trouvées sur le wiki de Arch Linux</a>.</p>

<h2>XFCE</h2>

<p>Ajouter au fichier <code>~/.config/xfce4/Xft.xrdb</code> la ligne suivante :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Xft.dpi: 180</span></code></pre></td></tr></table></div></figure>


<p>Dans Paramètres|Tableau de bord, on peut mettre le paramètre &ldquo;Taille d&#8217;une ligne&rdquo; à <code>48px</code>.</p>

<p>Dans les paramètres de zone de notification (accessible via un click droit sur la zone de
notification), on peut mettre la taille maximale d&#8217;une icône à <code>48px</code>.</p>

<p>On peut aussi modifier la taille des scrollbars en éditant le fichier <code>~/.gtkrc-2.0</code> :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>style "myscrollbar"
</span><span class='line'>{
</span><span class='line'>    GtkScrollbar::slider-width=20
</span><span class='line'>}
</span><span class='line'>class "GtkScrollbar" style "myscrollbar"</span></code></pre></td></tr></table></div></figure>


<h2>Firefox et Thunderbird</h2>

<p>Pour Firefox, dans <code>about:config</code> il faut rechercher la propriété <code>layout.css.devPixelsPerPx</code>
et lui donner la valeur <code>2</code>.</p>

<p>Pour Thunderbird, on peut accéder à l&#8217;éditeur de configuration dans Préférences|Avancé|Général
et mettre là aussi <code>layout.css.devPixelsPerPx</code> à <code>2</code>.</p>

<h2>urxvt</h2>

<p>Pour urxvt (paquet <code>rxvt-unicode</code>), on peut avoir une fonte de taille plus agréable en ajoutant
la ligne <code>urxvt.font: xft:DejaVuSansMono:size=10</code> au fichier <code>.Xresources</code>.</p>

<h2>Eclipse</h2>

<p>Malheureusement, pour l&#8217;instant <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=403993">Eclipse ne supporte pas le HiDPI </a>.</p>

<h2>Conclusion</h2>

<p>On peut donc utiliser un écran HiDPI avec une Ubuntu et XFCE et on peut espérer que les
quelques applications qui ne supportent pas encore les hautes résolutions seront corrigées
dans le futur.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/29/quand-utiliser-path-ou-url-avec-ruby-on-rails/">Quand Utiliser Les Helpers _path Et _url Avec Ruby on Rails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-29T15:23:50+01:00" pubdate data-updated="true">Mar 29<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Il y a deux façons d&#8217;exprimer les liens et URLs avec Ruby on Rails : _path &ndash; qui exprime un chemin relatif &ndash; et _url qui correspond au même chemin préfixé du nom d&#8217;hôte, du port et du path prefix.</p>

<p>D&#8217;après les <a href="http://www.ietf.org/rfc/rfc2616.txt">spécifications HTTP</a>, les redirections doivent spécifier une URI, ce qu&#8217;on peut interpréter comme un <em>fully qualified domain name</em> (nom de domaine complètement qualifié). On peut donc penser qu&#8217;il est préférable d&#8217;utiliser le helper _url lorsqu&#8217;on fait un redirect_to dans le code d&#8217;un controller.</p>

<p>Dans la pratique avec Ruby on Rails, on préfère utiliser _path plutôt que _url. En effet, le navigateur est capable de retrouver l&#8217;URL complète automatiquement en se basant sur les informations de la requête.</p>

<p>Pour résumer, si on veut être pointilleux il est conseillé d&#8217;utiliser _url pour les redirections et _path dans le code des vues (pour les liens par exemples). Quel que soit le choix effectué, le navigateur saura toujours reconstruire l&#8217;URL correctement.</p>

<p>Référence: <a href="https://www.informit.com/articles/article.aspx?p=1087656&amp;seqNum=17">Obie Fernandez &ndash; Routing the Rails Way</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/03/premier-code-kata/">FizzBuzz Kata en JavaScript</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-03T23:36:40+01:00" pubdate data-updated="true">Mar 3<span>rd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>J&#8217;ai créé un <a href="https://github.com/merwan/katas">repository sur github</a> pour stocker mes code katas.</p>

<p>Pour mon premier kata, je commence léger puisqu&#8217;il s&#8217;agit de <a href="http://craftsmanship.sv.cmu.edu/katas/fizzbuzz">FizzBuzz</a>. Le langage choisi est JavaScript et j&#8217;utilise le package npm jasmine-node pour faire tout cela en TDD :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install jasmine-node -g</span></code></pre></td></tr></table></div></figure>


<p>Pour cette implémentation, j&#8217;ai choisi de créer une méthode qui prend le nombre maximal jusqu&#8217;auquel on souhaite compter. Cette méthode retourne un tableau avec l&#8217;ensemble des valeurs à afficher. Le fichier de spec est alors :</p>

<figure class='code'><figcaption><span> (fizzbuzz_test.spec.js)</span> <a href='/downloads/code/fizzbuzz_test.spec.js'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">FizzBuzz</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./fizzbuzz&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;FizzBuzz&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">fizzBuzz</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FizzBuzz</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;counts 1&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fizzBuzz</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;counts 2&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fizzBuzz</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;counts 3&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fizzBuzz</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">]);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;counts 5&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fizzBuzz</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">]);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;counts 6&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fizzBuzz</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">]);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;counts 10&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fizzBuzz</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">]);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;counts 15&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fizzBuzz</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;FizzBuzz&quot;</span><span class="p">]);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Comme on peut le voir, c&#8217;est très verbeux et par conséquent c&#8217;est fastidieux d&#8217;ajouter un test.</p>

<p>Il n&#8217;y a pas de surprises dans l&#8217;implémentation :</p>

<figure class='code'><figcaption><span> (fizzbuzz.js)</span> <a href='/downloads/code/fizzbuzz.js'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">FizzBuzz</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">count</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">max</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">value</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">value</span> <span class="o">+=</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">value</span> <span class="o">+=</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">FizzBuzz</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Lors mon prochain essai, je changerai probablement l&#8217;API pour passer le nombre à &ldquo;traduire&rdquo; en argument d&#8217;une méthode. Cela permettra d&#8217;avoir des tests beaucoup plus concis et l&#8217;implémentation sera simplifiée. L&#8217;énumération des nombres sera alors déléguée au code appelant la méthode de FizzBuzz.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/01/presentation/">Présentation</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-01T15:59:02+01:00" pubdate data-updated="true">Mar 1<span>st</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Il est temps pour moi de commencer un blog en français en plus de mon <a href="http://nawrem.blogspot.com">blog anglais</a>.
Cela devrait me permettre d&#8217;écrire plus facilement. J&#8217;ai déjà quelques idées de thèmes:</p>

<ul>
<li>Découverte du code source de Ruby on Rails</li>
<li>Code katas en Ruby, Python, C# et peut-être Go</li>
<li>Suivi d&#8217;un projet de Single Page Application from
scratch (probablement du Angular côté client + du Node avec Express côté serveur)</li>
</ul>


<p>On verra dans quelques mois si j&#8217;arrive à mener tout cela à bien !</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/02/24/deployer-piwik-avec-django/">Déployer Piwik Avec Django</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/02/23/supprimer-toutes-les-tables-avec-django-17/">Supprimer Toutes Les Tables Avec Django 1.7</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/19/utiliser-XFCE-avec-un-ecran-HiDPI-ou-Retina/">Utiliser XFCE Avec Un écran HiDPI Ou &#8220;Retina&#8221;</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/29/quand-utiliser-path-ou-url-avec-ruby-on-rails/">Quand Utiliser Les Helpers _path Et _url Avec Ruby on Rails</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/03/premier-code-kata/">FizzBuzz Kata en JavaScript</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/merwan">@merwan</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'merwan',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Merouane Atig -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'merwanat';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
